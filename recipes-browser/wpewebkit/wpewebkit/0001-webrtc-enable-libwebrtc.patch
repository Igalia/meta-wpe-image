From a1be20483cdc6c76ede9ca1ba8b3050e95df9d51 Mon Sep 17 00:00:00 2001
From: Xabier Rodriguez-Calvar <calvaris@igalia.com>
Date: Wed, 16 Jul 2025 10:58:07 +0200
Subject: [PATCH] webrtc: enable libwebrtc

---
 Source/cmake/GStreamerChecks.cmake      | 11 +----------
 Source/cmake/GStreamerDefinitions.cmake |  4 +++-
 2 files changed, 4 insertions(+), 11 deletions(-)

diff --git a/Source/cmake/GStreamerChecks.cmake b/Source/cmake/GStreamerChecks.cmake
index 47222f94153d..92c8f570a184 100644
--- a/Source/cmake/GStreamerChecks.cmake
+++ b/Source/cmake/GStreamerChecks.cmake
@@ -58,16 +58,7 @@ if (ENABLE_VIDEO OR ENABLE_WEB_AUDIO OR ENABLE_WEB_CODECS)
 endif ()
 
 if (ENABLE_MEDIA_STREAM AND ENABLE_WEB_RTC)
-    if (USE_GSTREAMER_WEBRTC)
-        SET_AND_EXPOSE_TO_BUILD(USE_LIBWEBRTC FALSE)
-        # OpenSSL is required for SFrame encryption support.
-        find_package(OpenSSL)
-        if (NOT OPENSSL_FOUND OR OPENSSL_VERSION VERSION_LESS "3.0.0")
-            message(FATAL_ERROR "OpenSSL 3 is needed for ENABLE_WEB_RTC.")
-        endif ()
-    else ()
-        SET_AND_EXPOSE_TO_BUILD(USE_LIBWEBRTC TRUE)
-    endif ()
+  SET_AND_EXPOSE_TO_BUILD(USE_LIBWEBRTC TRUE)
 else ()
     SET_AND_EXPOSE_TO_BUILD(USE_LIBWEBRTC FALSE)
 endif ()
diff --git a/Source/cmake/GStreamerDefinitions.cmake b/Source/cmake/GStreamerDefinitions.cmake
index a508f4955d85..2f80c5f88e14 100644
--- a/Source/cmake/GStreamerDefinitions.cmake
+++ b/Source/cmake/GStreamerDefinitions.cmake
@@ -3,9 +3,11 @@ WEBKIT_OPTION_DEFAULT_PORT_VALUE(ENABLE_WEB_AUDIO PUBLIC ON)
 
 WEBKIT_OPTION_DEFAULT_PORT_VALUE(ENABLE_MEDIA_SOURCE PRIVATE ON)
 
+WEBKIT_OPTION_DEFAULT_PORT_VALUE(USE_LIBWEBRTC PUBLIC ON)
+
 WEBKIT_OPTION_DEFINE(USE_GSTREAMER_GL "Whether to enable support for GStreamer GL" PRIVATE ON)
 WEBKIT_OPTION_DEFINE(USE_GSTREAMER_MPEGTS "Whether to enable support for MPEG-TS" PRIVATE OFF)
 WEBKIT_OPTION_DEFINE(USE_GSTREAMER_FULL "Whether to enable support for static GStreamer builds" PRIVATE OFF)
 WEBKIT_OPTION_DEFINE(USE_GSTREAMER_TRANSCODER "Whether to enable support for GStreamer MediaRecorder backend" PUBLIC ON)
-WEBKIT_OPTION_DEFINE(USE_GSTREAMER_WEBRTC "Whether to enable support for WebRTC" PUBLIC ON)
+WEBKIT_OPTION_DEFINE(USE_GSTREAMER_WEBRTC "Whether to enable support for GstWebRTC" PUBLIC OFF)
 WEBKIT_OPTION_DEFINE(ENABLE_MEDIA_TELEMETRY "Whether to enable support for media telemetry" PRIVATE OFF)
-- 
2.47.2

